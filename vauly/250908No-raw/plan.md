---
description: "MVPとMillerの法則に基づいて最小限の設計書を作成します"
argument-hint: "[機能名]"
allowed-tools: Bash(find:*), Bash(grep:*), Bash(ls:*), Bash(head:*), Bash(cat:*)
model: claude-3-5-sonnet-20241022
---

# /plan - 設計書作成コマンド

あなたは設計書ドリブン開発のエキスパートです。機能「$ARGUMENTS」について、MVPとMillerの法則に基づいて最小限の設計書を作成してください。

## 前提条件
- **MVP**: 最小限の価値ある製品として必要な機能のみ
- **Millerの法則**: 一度に扱う要素は7±2個まで
- **スコープ厳守**: 設計書に記載されていない機能は実装しない

## 実行手順

### 1. 要件分析
要件「$ARGUMENTS」を以下の観点で分析してください：
- **コア価値**: この機能の本質的な価値
- **必須要素**: MVPとして絶対に必要な要素（最大7個）
- **除外要素**: 今回実装しない要素

### 2. 現在のコードベース確認
- プロジェクト構造: !`find . -name "*.js" -o -name "*.ts" -o -name "*.py" -o -name "*.go" | head -20`

### 3. 設計書生成とMCP保存
以下の構造で設計書を作成し、MCPサーバーにリソースとして保存してください：

#### MCP保存形式
- **Resource ID**: `plan-{generated-uuid}`
- **Resource Type**: `design-document`
- **Content**: 下記の設計書構造に従ったMarkdown形式

#### 設計書構造
```markdown
# [機能名] 設計書

## 1. 概要
- 目的
- スコープ（何をするか・何をしないか）
- 成功基準

## 2. 機能仕様
- 入力
- 処理
- 出力
- エラーハンドリング

## 3. 実装方針
- アーキテクチャ（最大7つのコンポーネント）
- データフロー
- 使用技術/ライブラリ

## 4. インターフェース定義
- API仕様（該当する場合）
- 関数シグネチャ
- データ構造

## 5. テスト方針
- テスト対象（設計書記載範囲のみ）
- テストケース概要
- 成功・失敗条件

## 6. 実装チェックリスト
- [ ] コア機能実装
- [ ] エラーハンドリング
- [ ] 基本テスト
- [ ] ドキュメント更新
```

### 4. 設計書の保存と管理
設計書をMCPサーバーに保存し、後続のワークフローで活用：
- 設計書保存: 作成した設計書をMCPサーバーのresourceとして保存
- UUID生成: 各設計書に一意のplan-uuidを生成・付与
- メタデータ記録: 作成日時、機能名、MVPスコープ等を記録

## 注意事項
- 設計書に記載されていない機能追加は禁止
- 不明な点は明確にし、実装時の判断基準を示す
- 既存コードとの整合性を確認
- 将来の拡張可能性よりも現在のシンプルさを優先